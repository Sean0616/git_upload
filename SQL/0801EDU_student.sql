  CREATE TABLE "STUDENT"."X" 
   (
    "PK" VARCHAR2(20 BYTE), 
	"X1" VARCHAR2(20 BYTE), 
	"X02" VARCHAR2(20 BYTE), 
	"X03" VARCHAR2(100 BYTE), 
	"X04" VARCHAR2(100 BYTE), 
	"X05" VARCHAR2(100 BYTE), 
	"X06" VARCHAR2(100 BYTE), 
	 )
     
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A01', 'C001', '大埔里', '竹南鎮公義路1035號', '03 758 1072', '公寓', '1')    
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A02', 'C002', '竹南里', '竹南鎮竹南里中山路 103 號', '037-472735', '大樓', '1')
INSERT INTO "STUDENT"."X" (PK, X01,,X02, X03, X04, X05, X06) VALUES ('A03', 'C003', '竹南鎮山佳里國光街 14 號', '037-614186', '大樓', '1')
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A04', 'C004', '埔頂里', '後龍鎮埔頂里中興路136-1號', '037-724839', '公共設施', '1')
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A05', 'C005', '綠苗里', '苗栗市綠苗里中正路 766 號', '037-333240', '公寓', '2')
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A06', 'C006', '民族里', '民族里民族路96號', '037-660001', '公共設施', '1')
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A07', 'C007', '忠孝里', '忠孝里光大街82號', '037-661145', '私營單位', '1')
INSERT INTO "STUDENT"."X" (PK, X01, X02, X03, X04, X05, X06) VALUES ('A08', 'C008', '信義里', '信義里信義路53巷1號', '037-616072', '公寓', '1')



  CREATE TABLE "STUDENT"."Y" 
   (
    "PK" VARCHAR2(20 BYTE), 
	"Y01" VARCHAR2(100 BYTE), 
	"Y02" VARCHAR2(100 BYTE), 
	"Y03" VARCHAR2(100 BYTE), 
	"Y04" VARCHAR2(100 BYTE)
   ) 

INSERT INTO "STUDENT"."Y" (PK, Y01, COLUMN1, Y03, Y04) VALUES ('B01', 'M001', '竹南分局', '苗栗縣竹南鎮民族街72號', '03 747 4796')
INSERT INTO "STUDENT"."Y" (PK, Y01, COLUMN1, Y03, Y04) VALUES ('B02', 'M002', '苗栗分局', '苗栗縣苗栗市金鳳街109號', '03 732 0059')
INSERT INTO "STUDENT"."Y" (PK, Y01, COLUMN1, Y03, Y04) VALUES ('B03', 'M003', '頭份分局', '苗栗縣頭份市中興路503號', '03 766 3004')


CREATE TABLE "STUDENT"."Z" 
   (
    "PK" VARCHAR2(20 BYTE), 
	"Z01" VARCHAR2(100 BYTE), 
	"Z02" VARCHAR2(100 BYTE), 
	"Z03" VARCHAR2(100 BYTE), 
	"Z04" VARCHAR2(100 BYTE)
   ) 
   
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D01', '苗栗縣竹南鎮中埔街20號', '100','C001','M001')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D02', '苗栗縣竹南鎮和平街79號', '3142','C002','M001')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D03', '苗栗縣竹南鎮龍山路三段142號', '1072','C003','M001')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D04', '苗栗縣後龍鎮中華路1498號', '32','C004','M001')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D05', '苗栗縣苗栗市米市街80號', '106','C005','M002')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D06', '苗栗縣苗栗市光復路117號', '26','C005','M002')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D07', '苗栗縣苗栗市博愛街109號', '2038','C005','M002')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D08', '苗栗縣苗栗市大同路53號', '128','C005','M002')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D09', '苗栗縣頭份市民族里和平路102號', '353','C006','M003')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D010', '苗栗縣頭份市忠孝忠孝一路69號', '501','C007','M003')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D011', '苗栗縣頭份市信義里中正路65號', '194','C008','M003')
INSERT INTO "STUDENT"."Z" (PK, Z01, Z02, Z03, Z04) VALUES ('D012', '苗栗縣頭份市信義里中正路116號', '178','C008','M003')

--4-1
SELECT DISTINCT Y02,Y04
FROM Y
LEFT JOIN Z ON Z04 = Y01
WHERE Z02 > 1000
--4-2
SELECT Y02,Y04, COUNT(Y02) AS CNT
FROM Z
LEFT JOIN Y ON Y01 = Z04
WHERE  Z02 > 1000
GROUP BY Y02,Y03
--4-3
SELECT Y02,Y04, COUNT(Z01) OVER (PARTITION BY Y02),X05, Z01
FROM Z
LEFT JOIN Y ON Y01 = Z04
LEFT JOIN X ON X01 = Z03
WHERE  Z02 > 1000
GROUP BY Y02,Y03,X05,Z01
--4-4
SELECT X02, Z01, Z02, Y02, Y04
FROM Z
LEFT JOIN Y ON Y01 = Z04
LEFT JOIN X ON X01 = Z03
WHERE Z01 LIKE '%中%'
--4-5
SELECT X02, X03, Z01, Z02 
FROM Z
LEFT JOIN Y ON Y01 = Z04
LEFT JOIN X ON X01 = Z03
WHERE X05 = '公寓' OR X05 = '大樓'
--5-1
UPDATE Z
SET Z02 = '5000'
WHERE Z01= '苗栗縣竹南鎮和平街79號'
--5-2
DELETE FROM Z
WHERE Z02 < 1000